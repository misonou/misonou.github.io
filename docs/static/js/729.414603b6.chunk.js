"use strict";(self.webpackChunkbrewjs_for_react_router_example=self.webpackChunkbrewjs_for_react_router_example||[]).push([[729],{729:function(e,n,t){t.r(n);var s=t(2556);function o(e){const n=Object.assign({h1:"h1",p:"p",blockquote:"blockquote",code:"code",pre:"pre",h2:"h2",h3:"h3",h4:"h4",ul:"ul",li:"li",strong:"strong"},e.components),{Module:t,ImportHint:o,VersionTimeline:i,Badge:l}=n;return l||r("Badge",!1),l.Optional||r("Badge.Optional",!0),l.Version||r("Badge.Version",!0),o||r("ImportHint",!0),t||r("Module",!0),i||r("VersionTimeline",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t,{name:"zeta-dom-react"}),"\n",(0,s.jsx)(n.h1,{children:"useSingleton"}),"\n",(0,s.jsx)(n.p,{children:"Makes sure the dispose callback only gets called once when component is unmounted."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Since React 18 ",(0,s.jsx)(n.code,{children:"useEffect"})," always gets executed twice in development strict mode.\r\nThis may cause issues for singleton objects that they are cleaned up before actual component life cycle.\r\nThis hook ensures the cleanup callback will only be invoked exactly once after the component has unmounted."]}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"In addition, singleton objects discarded in the first execution of factory callback in development strict mode\r\nwill also get properly disposed."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"const singleton = useState(factory)[0];\r\n// factory will be called twice in development strict mode\r\n// where the first singleton instance returned is discarded after second execution\r\nuseEffect(() => {\r\n    return () => {\r\n        // the `dispose` method will actually be called\r\n        // when component is being first mounted in development strict mode,\r\n        // so the internal state will be invalid when component is rerendered.\r\n        singleton.dispose();\r\n    };\r\n}, [singleton]);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Instead the following will be safe in development strict mode:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-tsx",children:"const singleton = useSingleton(factory);\n"})}),"\n",(0,s.jsx)(n.h2,{children:"Syntax"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"useSingleton(factory)\r\nuseSingleton(factory, onDispose)\r\nuseSingleton(target)\r\nuseSingleton(target, onDispose)\n"})}),"\n",(0,s.jsx)(o,{name:"useSingleton",module:"zeta-dom-react",require:"useSingleton",global:"zeta.react.useSingleton"}),"\n",(0,s.jsx)(n.h3,{children:"Parameters"}),"\n",(0,s.jsxs)("dl",{children:[(0,s.jsx)(n.h4,{children:(0,s.jsx)(n.code,{children:"factory"})}),(0,s.jsx)(n.p,{children:"A callback that returns a singleton object."}),(0,s.jsxs)(n.h4,{children:[(0,s.jsx)(n.code,{children:"target"})," ",(0,s.jsx)(l.Version,{})]}),(0,s.jsx)(n.p,{children:"A singleton object."}),(0,s.jsxs)(n.h4,{children:[(0,s.jsx)(n.code,{children:"onDispose"})," ",(0,s.jsx)(l.Optional,{})]}),(0,s.jsxs)(n.p,{children:["Callback to be invoked when component has unmounted.\r\nIf unspecified, it will call ",(0,s.jsx)(n.code,{children:"dispose"})," method on the object if there exists usch method."]})]}),"\n",(0,s.jsx)(n.h3,{children:"Return value"}),"\n",(0,s.jsxs)(n.p,{children:["The object returned from the ",(0,s.jsx)(n.code,{children:"factory"})," callback."]}),"\n",(0,s.jsx)(n.h2,{children:"Version information"}),"\n",(0,s.jsx)(i,{module:"zeta-dom-react",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"0.4.6"})," Introduced"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"0.4.14"})," ",(0,s.jsx)(n.code,{children:"target"})," parameter"]}),"\n"]})})]})}function r(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}n.default=function(e={}){const{wrapper:n}=e.components||{};return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(o,e)})):o(e)}}}]);