"use strict";(self.webpackChunkbrewjs_for_react_router_example=self.webpackChunkbrewjs_for_react_router_example||[]).push([[3912],{3912:function(n,r,e){e.r(r),e.d(r,{default:function(){return C}});var o=e(2556),t=e(885),i=e(4165),a=e(1929),s=e(2527),c=e(8252),l=e(7749),d=e(6665),u=e(4519),p=function(n,r,e,o){return new(e||(e=Promise))((function(t,i){function a(n){try{c(o.next(n))}catch(r){i(r)}}function s(n){try{c(o.throw(n))}catch(r){i(r)}}function c(n){var r;n.done?t(n.value):(r=n.value,r instanceof e?r:new e((function(n){n(r)}))).then(a,s)}c((o=o.apply(n,r||[])).next())}))};function m(){var n=(0,u.useState)(),r=(0,t.Z)(n,2),e=r[0],m=r[1],g=(0,s.vS)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("p",{children:["Result: ",e]}),(0,o.jsx)("button",Object.assign({},c.Z.use(g),{type:"button",onClick:(0,d.Y7)((function(){return(0,a.v)({className:"app-dialog app-demo-view",onCommit:function(){return p(this,void 0,void 0,(0,i.Z)().mark((function n(){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,l.gw)(3e3);case 2:return n.abrupt("return",Math.random());case 3:case"end":return n.stop()}}),n)})))},onRender:function(n){var r=n.closeDialog,e=(0,s.vS)();return(0,o.jsxs)("div",{children:[(0,o.jsx)("p",{children:"This is my content"}),(0,o.jsx)("button",Object.assign({},c.Z.use(e),{type:"button",onClick:(0,d.Y7)((function(){return r()}),{lock:!0})},{children:"Close"}))]})}}).open().then(m)}))},{children:"Open dialog"}))]})}var g='import { Mixin, createDialog, useLoadingStateMixin } from "brew-js-react";\r\nimport { delay } from "zeta-dom/util";\r\nimport { handleUserAction } from "@misonou/react-app-utils";\r\nimport { useState } from "react";\r\n\r\nfunction openDialog() {\r\n    const dialog = createDialog({\r\n        className: \'app-dialog app-demo-view\',\r\n        // notice that onCommit will not be invoke when\r\n        // dialog is closed by clicking outside or tapping escape key\r\n        async onCommit() {\r\n            await delay(3000);\r\n            return Math.random();\r\n        },\r\n        onRender({ closeDialog }) {\r\n            const loadingState = useLoadingStateMixin();\r\n            return (\r\n                <div>\r\n                    <p>This is my content</p>\r\n                    <button\r\n                        {...Mixin.use(loadingState)}\r\n                        type="button"\r\n                        onClick={handleUserAction(() => closeDialog(), { lock: true })}>Close</button>\r\n                </div>\r\n            );\r\n        }\r\n    });\r\n    return dialog.open();\r\n}\r\n\r\nexport default function Component() {\r\n    const [result, setResult] = useState<number | undefined>();\r\n    const loadingState = useLoadingStateMixin();\r\n    return (\r\n        <>\r\n            <p>Result: {result}</p>\r\n            <button\r\n                {...Mixin.use(loadingState)}\r\n                type="button"\r\n                onClick={handleUserAction(() => openDialog().then(setResult))}>Open dialog</button>\r\n        </>\r\n    );\r\n}\r\n',h=e(1184),f=e(6119);function x(){return(0,o.jsx)(f.iV,{component:m,source:{tsx:g,css:h.Z}})}function b(){return(0,a.v)({className:"app-dialog app-demo-view",onCommit:function(n){throw new Error("Failed ".concat(n+1," time(s)"))},onRender:function(n){var r=n.commitDialog,e=n.errorHandler,i=(0,u.useState)(0),a=(0,t.Z)(i,2),s=a[0],c=a[1],l=(0,u.useState)(""),p=(0,t.Z)(l,2),m=p[0],g=p[1];return(0,u.useEffect)((function(){return e.catch((function(n){return c((function(n){return n+1})),g(n.message),!0}))}),[]),(0,o.jsxs)("div",{children:[m&&(0,o.jsx)("p",{children:m}),(0,o.jsx)("button",Object.assign({onClick:(0,d.Y7)((function(){return r(s)}))},{children:"Submit"}))]})}}).open()}function j(){return(0,o.jsx)("button",Object.assign({onClick:b},{children:"Open dialog"}))}var v='import { createDialog } from "brew-js-react";\r\nimport { handleUserAction } from "@misonou/react-app-utils";\r\nimport { useEffect, useState } from "react";\r\n\r\nfunction openDialog() {\r\n    const dialog = createDialog({\r\n        className: \'app-dialog app-demo-view\',\r\n        onCommit(retryCount: number) {\r\n            throw new Error(`Failed ${retryCount + 1} time(s)`);\r\n        },\r\n        onRender({ commitDialog, errorHandler }) {\r\n            const [failedCount, setFailedCount] = useState(0);\r\n            const [errorMessage, setErrorMessage] = useState(\'\');\r\n            useEffect(() => {\r\n                return errorHandler.catch((e) => {\r\n                    setFailedCount(v => v + 1);\r\n                    setErrorMessage(e.message);\r\n                    return true;\r\n                });\r\n            }, []);\r\n            return (\r\n                <div>\r\n                    {errorMessage && <p>{errorMessage}</p>}\r\n                    <button onClick={handleUserAction(() => commitDialog(failedCount))}>Submit</button>\r\n                </div>\r\n            );\r\n        }\r\n    });\r\n    return dialog.open();\r\n}\r\n\r\nexport default function Component() {\r\n    return (\r\n        <button onClick={openDialog}>Open dialog</button>\r\n    );\r\n}\r\n';function w(){return(0,o.jsx)(f.iV,{component:j,source:{tsx:v,css:h.Z}})}function k(n){const r=Object.assign({h1:"h1",p:"p",code:"code",a:"a",blockquote:"blockquote",pre:"pre",h2:"h2",del:"del"},n.components),{Module:e}=r;return e||function(n,r){throw new Error("Expected "+(r?"component":"object")+" `"+n+"` to be defined: you likely forgot to import, pass, or provide it.")}("Module",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e,{name:"brew-js-react"}),"\n",(0,o.jsx)(r.h1,{children:"Foreground operation"}),"\n",(0,o.jsxs)(r.p,{children:["The ",(0,o.jsx)(r.code,{children:"onCommit"})," option for ",(0,o.jsx)(r.a,{href:":",children:(0,o.jsx)(r.code,{children:"createDialog"})})," allows performing operations in foreground,\r\nkeeping the dialog open, when user confirms in a prompt."]}),"\n",(0,o.jsxs)(r.p,{children:["The callback will receive committed value sent from ",(0,o.jsx)(r.a,{href:":",children:(0,o.jsx)(r.code,{children:"DialogRenderComponentProps.closeDialog"})}),"\r\nin ",(0,o.jsx)(r.code,{children:"onRender"})," callback."]}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsxs)(r.p,{children:["If the dialog is closed due to lost of focus, or by calling ",(0,o.jsx)(r.a,{href:":",children:(0,o.jsx)(r.code,{children:"DialogState.close"})}),", the ",(0,o.jsx)(r.code,{children:"onCommit"})," callback will not be invoked."]}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-javascript",children:"createDialog({\r\n    /* ... */\r\n    // receive value from user input\r\n    onCommit(value) {\r\n        /* ... */\r\n    }\r\n});\n"})}),"\n",(0,o.jsx)(x,{}),"\n",(0,o.jsxs)(r.p,{children:["If the operation fails, i.e. the promise returned by ",(0,o.jsx)(r.code,{children:"onCommit"})," callback rejects, the dialog will remain open,\r\nallowing user to commit again or to cancel and close the dialog."]}),"\n",(0,o.jsx)(r.h2,{children:"Abort signal"}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.del,{children:"0.6.0"})}),"\n",(0,o.jsxs)(r.p,{children:["Since 0.6.0, the ",(0,o.jsx)(r.code,{children:"onCommit"})," callback receive an ",(0,o.jsx)(r.code,{children:"AbortSignal"})," object, which signals when dialog is closed during commit action:"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-javascript",children:"createDialog({\r\n    /* ... */\r\n    onCommit(value, { signal }) {\r\n        /* ... */\r\n    }\r\n});\n"})}),"\n",(0,o.jsx)(r.h2,{children:"Error handling"}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.del,{children:"0.6.4"})}),"\n",(0,o.jsx)(w,{})]})}var C=function(n={}){const{wrapper:r}=n.components||{};return r?(0,o.jsx)(r,Object.assign({},n,{children:(0,o.jsx)(k,n)})):k(n)}},1184:function(n,r){r.Z=".app-dialog {\r\n    position: fixed;\r\n    display: flex;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    z-index: 1000;\r\n    background-color: #0009;\r\n    align-items: center;\r\n    justify-content: center;\r\n    pointer-events: none;\r\n    opacity: 0;\r\n    transition: opacity 0.2s;\r\n}\r\n\r\n.app-dialog[is-modal] {\r\n    pointer-events: all;\r\n}\r\n\r\n.app-dialog.open {\r\n    opacity: 1;\r\n}\r\n\r\n.app-dialog.open.closing {\r\n    opacity: 0;\r\n}\r\n\r\n.app-dialog > div {\r\n    position: relative;\r\n    padding: 1em;\r\n    min-width: 10em;\r\n    background-color: var(--color-background);\r\n    border-radius: var(--border-radius);\r\n    box-shadow: var(--overlay-box-shadow);\r\n    pointer-events: all;\r\n}\r\n\r\n.app-dialog.loading > div:before {\r\n    position: absolute;\r\n    z-index: 1;\r\n    content: '';\r\n    bottom: 0;\r\n    left: 0;\r\n    animation: loading-bar 1000s;\r\n    border-bottom: 4px solid var(--color-highlight);\r\n    border-radius: 0 0 var(--border-radius) var(--border-radius);\r\n    transition: right 0.2s;\r\n}\r\n\r\n.app-dialog.closing > div:before {\r\n    animation-duration: 0.5s;\r\n    right: 0;\r\n}\r\n"}}]);